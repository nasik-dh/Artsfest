<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Details - Arts Festival 2024</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">Arts Festival 2024</div>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="admin.html">Admin</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="team-header">
            <h1 id="teamName">Team Name</h1>
            <div class="team-score">
                <h2>Total Points: <span id="totalPoints">0</span> / <span id="maxPoints">0</span></h2>
            </div>
        </section>

        <section class="candidates-section">
            <h2>Team Members</h2>
            <div class="candidates-container" id="candidatesContainer">
                <!-- Candidates will be loaded here -->
            </div>
        </section>
    </main>

    <script src="js/config.js"></script>
    <script>
        // Team page specific JavaScript
        const urlParams = new URLSearchParams(window.location.search);
        const teamId = urlParams.get('team');

        async function loadTeamData() {
            try {
                // Load team info
                const teamsResponse = await fetch(`${API_BASE_URL}?action=getTeams`);
                const teams = await teamsResponse.json();
                const team = teams.find(t => t.team_id == teamId);
                
                if (team) {
                    document.getElementById('teamName').textContent = team.team_name;
                }

                // Load candidates
                const candidatesResponse = await fetch(`${API_BASE_URL}?action=getCandidates&team_id=${teamId}`);
                const candidates = await candidatesResponse.json();
                
                displayCandidates(candidates);
                calculateTeamPoints(candidates);
            } catch (error) {
                console.error('Error loading team data:', error);
            }
        }

        function displayCandidates(candidates) {
            const container = document.getElementById('candidatesContainer');
            container.innerHTML = '';

            candidates.forEach(candidate => {
                const candidateDiv = document.createElement('div');
                candidateDiv.className = 'candidate-card';
                candidateDiv.innerHTML = `
                    <div class="candidate-image">
                        <img src="${candidate.image_url}" alt="${candidate.name}">
                        <div class="points-bubble">${candidate.total_points}</div>
                    </div>
                    <h3>${candidate.name}</h3>
                `;
                container.appendChild(candidateDiv);
            });
        }

        function calculateTeamPoints(candidates) {
            const totalPoints = candidates.reduce((sum, candidate) => sum + candidate.total_points, 0);
            document.getElementById('totalPoints').textContent = totalPoints;
            // You can set max points based on your calculation logic
            document.getElementById('maxPoints').textContent = candidates.length * 100; // Example max
        }

        loadTeamData();
    </script>
</body>
</html>
